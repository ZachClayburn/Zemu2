#ifndef ZEMU2_BOOTROM_H
#define ZEMU2_BOOTROM_H

#include <array>
#include "ReadWriteDevice.h"

class BootRom : public ReadWriteDevice
{
  public:
    uint8_t read(uint16_t addr) override;

    void write(uint16_t addr, uint8_t val) override;

    bool accepts(uint16_t addr) override;
    
    bool bootComplete();

  private:
    bool enabled{ true };
    
    const uint16_t LOWER_BOUND{ 0x0000U };
    const uint16_t UPPER_BOUND{ 0x00FFU };
    const uint16_t BOOT_REG_ADDR{ 0x00FFU };
    const uint8_t BOOT_REG_SHUTDOWN{ 0x01U };
    
    static const constexpr std::array<uint8_t, 256> bootRom = {
      0x31U,0xFEU,0xFFU,0xAFU,0x21U,0xFFU,0x9FU,0x32U,0xCBU,0x7CU,0x20U,0xFBU,0x21U,0x26U,0xFFU,0x0EU,
      0x11U,0x3EU,0x80U,0x32U,0xE2U,0x0CU,0x3EU,0xF3U,0xE2U,0x32U,0x3EU,0x77U,0x77U,0x3EU,0xFCU,0xE0U,
      0x47U,0x11U,0x04U,0x01U,0x21U,0x10U,0x80U,0x1AU,0xCDU,0x95U,0x00U,0xCDU,0x96U,0x00U,0x13U,0x7BU,
      0xFEU,0x34U,0x20U,0xF3U,0x11U,0xD8U,0x00U,0x06U,0x08U,0x1AU,0x13U,0x22U,0x23U,0x05U,0x20U,0xF9U,
      0x3EU,0x19U,0xEAU,0x10U,0x99U,0x21U,0x2FU,0x99U,0x0EU,0x0CU,0x3DU,0x28U,0x08U,0x32U,0x0DU,0x20U,
      0xF9U,0x2EU,0x0FU,0x18U,0xF3U,0x67U,0x3EU,0x64U,0x57U,0xE0U,0x42U,0x3EU,0x91U,0xE0U,0x40U,0x04U,
      0x1EU,0x02U,0x0EU,0x0CU,0xF0U,0x44U,0xFEU,0x90U,0x20U,0xFAU,0x0DU,0x20U,0xF7U,0x1DU,0x20U,0xF2U,
      0x0EU,0x13U,0x24U,0x7CU,0x1EU,0x83U,0xFEU,0x62U,0x28U,0x06U,0x1EU,0xC1U,0xFEU,0x64U,0x20U,0x06U,
      0x7BU,0xE2U,0x0CU,0x3EU,0x87U,0xE2U,0xF0U,0x42U,0x90U,0xE0U,0x42U,0x15U,0x20U,0xD2U,0x05U,0x20U,
      0x4FU,0x16U,0x20U,0x18U,0xCBU,0x4FU,0x06U,0x04U,0xC5U,0xCBU,0x11U,0x17U,0xC1U,0xCBU,0x11U,0x17U,
      0x05U,0x20U,0xF5U,0x22U,0x23U,0x22U,0x23U,0xC9U,0xCEU,0xEDU,0x66U,0x66U,0xCCU,0x0DU,0x00U,0x0BU,
      0x03U,0x73U,0x00U,0x83U,0x00U,0x0CU,0x00U,0x0DU,0x00U,0x08U,0x11U,0x1FU,0x88U,0x89U,0x00U,0x0EU,
      0xDCU,0xCCU,0x6EU,0xE6U,0xDDU,0xDDU,0xD9U,0x99U,0xBBU,0xBBU,0x67U,0x63U,0x6EU,0x0EU,0xECU,0xCCU,
      0xDDU,0xDCU,0x99U,0x9FU,0xBBU,0xB9U,0x33U,0x3EU,0x3CU,0x42U,0xB9U,0xA5U,0xB9U,0xA5U,0x42U,0x3CU,
      0x21U,0x04U,0x01U,0x11U,0xA8U,0x00U,0x1AU,0x13U,0xBEU,0x20U,0xFEU,0x23U,0x7DU,0xFEU,0x34U,0x20U,
      0xF5U,0x06U,0x19U,0x78U,0x86U,0x23U,0x05U,0x20U,0xFBU,0x86U,0x20U,0xFEU,0x3EU,0x01U,0xE0U,0x50U,
    };
    
};


#endif//ZEMU2_BOOTROM_H
